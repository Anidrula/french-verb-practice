<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>French Verb Conjugation Practice</title>
<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #d9ecff;
        margin: 0;
        padding: 20px;
        display: flex;
        justify-content: center;
        color: #154a7e;
    }
    .conj-block {
        background: #f0f7ff;
        padding: 30px 40px;
        border-radius: 12px;
        max-width: 850px;
        width: 100%;
        box-sizing: border-box;
        box-shadow: 0 5px 15px rgba(21, 74, 126, 0.2);
    }
    h2, h3 {
        margin-bottom: 24px;
    }
    .toggle-group {
        background: #eef6ff;
        border-radius: 10px;
        padding: 10px 16px 18px 16px;
        margin-bottom: 20px;
        box-sizing: border-box;
    }
    .toggle-group label {
        margin-right: 24px;
        font-weight: 600;
        cursor: pointer;
    }
    .toggle-group input[type="checkbox"], .toggle-group input[type="text"] {
        margin-right: 8px;
    }
    table {
        border-collapse: collapse;
        width: 100%;
        background: #e6f0ff;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 20px;
    }
    th, td {
        border: 1px solid #b5d1ff;
        padding: 14px 16px;
        text-align: center;
        font-size: 1.2rem;
        vertical-align: middle;
    }
    input[type="text"] {
        padding: 12px;
        font-size: 1.2rem;
        border-radius: 8px;
        border: 1px solid #7fb1ff;
        width: 140px;
        box-sizing: border-box;
        transition: border-color 0.2s ease;
    }
    input[type="text"]:focus {
        outline: none;
        border-color: #3a7bd5;
        box-shadow: 0 0 6px #3a7bd5aa;
    }
    .btn {
        padding: 10px 28px;
        margin: 14px 14px 0 0;
        font-size: 1.1rem;
        border-radius: 10px;
        border: 1px solid #3a7bd5;
        background-color: #6799ff;
        color: white;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.25s ease;
    }
    .btn:hover {
        background-color: #3a7bd5;
    }
    .score {
        margin-top: 20px;
        font-weight: 600;
        font-size: 1.25rem;
        color: #123a6d;
    }
    .prev-block {
        background: #d3e2ff;
        padding: 18px 25px;
        margin: 30px 0 0 0;
        border-radius: 12px;
        box-sizing: border-box;
        max-height: 250px;
        overflow-y: auto;
    }
    .prev-block h4 {
        margin-top: 0;
        color: #0f2d66;
    }
    .correct {
        background-color: #addfad;
        border: 1px solid #469436;
        color: #1a3e12;
    }
    .incorrect {
        background-color: #f8b1ae;
        border: 1px solid #d5453d;
        color: #7b1d19;
    }
    /* Responsive */
    @media only screen and (max-width: 600px) {
        body {
            padding: 12px;
        }
        .conj-block {
            padding: 24px 18px;
            max-width: 100%;
        }
        th, td {
            font-size: 1rem;
            padding: 10px 8px;
        }
        input[type="text"] {
            width: 100%;
            font-size: 1.1rem;
            padding: 14px;
        }
        .btn {
            width: 100%;
            margin: 12px 0 0 0;
        }
        .btn + .btn {
            margin-left: 0;
        }
        .prev-block {
            max-height: 180px;
            padding: 14px 16px;
        }
    }
</style>
</head>
<body>
<div class="conj-block" role="main" aria-label="French Verb Conjugation Practice">
    <h2>Practice French Verb Conjugation – <span id="verbTitle" style="color:#3a7bd5; font-weight:700;">savoir</span></h2>

    <div class="toggle-group" aria-label="Options">
        <label><input type="checkbox" id="toggleTenses" checked /> Random tenses enabled</label>
        <label><input type="checkbox" id="togglePronominal" checked /> Pronominal forms enabled</label>
        <label style="margin-left: 24px; font-weight: 600;">
            Or enter a specific verb:
            <input type="text" id="searchVerb" placeholder="Type verb here (e.g. vouloir)" aria-label="Specific verb to practice" style="width: 180px; font-size: 1rem;"/>
        </label>
    </div>

    <div id="description"></div>

    <form id="practiceForm" autocomplete="off" aria-labelledby="description">
        <table>
            <thead>
            <tr>
                <th scope="col">Subject</th>
                <th scope="col">Verb</th>
                <th scope="col" id="pronominal-header">Pronominal form</th>
            </tr>
            </thead>
            <tbody id="practiceRows">
            <!-- Rows will be dynamically generated -->
            </tbody>
        </table>

        <button class="btn" type="button" onclick="checkAnswers()">Check Answers</button>
        <button class="btn" type="button" onclick="nextRound()">Next Round</button>
        <button class="btn" type="button" onclick="resetForm()">Reset</button>
    </form>

    <div class="score" id="scoreBlock" aria-live="polite"></div>

    <div class="prev-block" id="prevAnswersBlock" style="display:none;">
        <h4>Previous Attempts</h4>
        <ul id="prevAnswersList" aria-live="polite"></ul>
    </div>
</div>

<script>
const verbData = {
    'savoir': {
        'Présent': { 'je': ['sais', 'me sais'], 'tu': ['sais', 'te sais'], 'il': ['sait', 'se sait'], 'nous': ['savons', 'nous savons'], 'vous': ['savez', 'vous savez'], 'ils': ['savent', 'se savent'] },
        'Imparfait': { 'je': ['savais', 'me savais'], 'tu': ['savais', 'te savais'], 'il': ['savait', 'se savait'], 'nous': ['savions', 'nous savions'], 'vous': ['saviez', 'vous saviez'], 'ils': ['savaient', 'se savaient'] },
        'Futur simple': { 'je': ['saurai', 'me saurai'], 'tu': ['sauras', 'te sauras'], 'il': ['saura', 'se saura'], 'nous': ['saurons', 'nous saurons'], 'vous': ['saurez', 'vous saurez'], 'ils': ['sauront', 'se sauront'] },
        'Passé composé': { 'je': ['ai su', 'me suis su'], 'tu': ['as su', 't\'es su'], 'il': ['a su', 's\'est su'], 'nous': ['avons su', 'nous sommes sus'], 'vous': ['avez su', 'vous êtes sus'], 'ils': ['ont su', 'se sont sus'] },
        'Plus-que-parfait': { 'je': ['avais su', 'm\'étais su'], 'tu': ['avais su', 't\'étais su'], 'il': ['avait su', 's\'était su'], 'nous': ['avions su', 'nous étions sus'], 'vous': ['aviez su', 'vous étiez sus'], 'ils': ['avaient su', 's\'étaient sus'] },
        'Conditionnel': { 'je': ['saurais', 'me saurais'], 'tu': ['saurais', 'te saurais'], 'il': ['saurait', 'se saurait'], 'nous': ['saurions', 'nous saurions'], 'vous': ['sauriez', 'vous sauriez'], 'ils': ['sauraient', 'se sauraient'] }
    },
    // You can add more verbs here, e.g. 'vouloir', 'aller', ...
};

const tenses = ['Présent', 'Imparfait', 'Futur simple', 'Passé composé', 'Plus-que-parfait', 'Conditionnel'];
const subjects = ['je', 'tu', 'il', 'nous', 'vous', 'ils'];

let currentVerb = 'savoir';
let currentTense = tenses[0];
let useRandomTense = true;
let usePronominal = true;
let prevAnswers = [];

const toggleTenses = document.getElementById('toggleTenses');
const togglePronominal = document.getElementById('togglePronominal');
const searchVerb = document.getElementById('searchVerb');

toggleTenses.addEventListener('change', () => {
    useRandomTense = toggleTenses.checked;
    randomizeTense();
});

togglePronominal.addEventListener('change', () => {
    usePronominal = togglePronominal.checked;
    renderPracticeTable();
});

searchVerb.addEventListener('input', () => {
    const typedVerb = searchVerb.value.trim().toLowerCase();
    if (typedVerb.length > 0 && verbData.hasOwnProperty(typedVerb)) {
        currentVerb = typedVerb;
    } else {
        currentVerb = 'savoir'; // fallback default
    }
    randomizeTense();
});

// Helper: Render the practice rows in the table according to settings
function renderPracticeTable() {
    const tbody = document.getElementById('practiceRows');
    tbody.innerHTML = '';
    subjects.forEach(sub => {
        const tr = document.createElement('tr');
        
        const tdSubj = document.createElement('td');
        tdSubj.textContent = sub;
        tr.appendChild(tdSubj);

        // Verb form cell/input
        const tdVerb = document.createElement('td');
        const inputVerb = document.createElement('input');
        inputVerb.type = 'text';
        inputVerb.name = `verb-${sub}`;
        inputVerb.id = `verb-${sub}`;
        inputVerb.setAttribute('autocomplete', 'off');
        tdVerb.appendChild(inputVerb);
        tr.appendChild(tdVerb);

        // Pronominal form cell/input
        const tdPronom = document.createElement('td');
        if (usePronominal) {
            const inputPronom = document.createElement('input');
            inputPronom.type = 'text';
            inputPronom.name = `pronominal-${sub}`;
            inputPronom.id = `pronominal-${sub}`;
            inputPronom.setAttribute('autocomplete', 'off');
            tdPronom.appendChild(inputPronom);
        } else {
            tdPronom.textContent = '';
        }
        tr.appendChild(tdPronom);

        tbody.appendChild(tr);
    });

    // Show/hide pronominal column header
    const pronominalHeader = document.getElementById('pronominal-header');
    pronominalHeader.style.display = usePronominal ? '' : 'none';
}

function updateDescription() {
    const descElem = document.getElementById('description');
    descElem.innerHTML = `<h3>Practice conjugating <span style="color:#3a7bd5; font-weight:bold;">${currentVerb}</span> ${usePronominal ? "and its pronominal form " : ""}in ${currentTense} tense.</h3>
        <p>Fill in the correct forms below and click 'Check Answers'.</p>`;
}

// Picks a random tense if enabled, or keeps current tense
function randomizeTense() {
    if (useRandomTense) {
        const idx = Math.floor(Math.random() * tenses.length);
        currentTense = tenses[idx];
    }
    updateDescription();
    renderPracticeTable();
    resetForm();
    clearScore();
}

function checkAnswers() {
    const form = document.getElementById('practiceForm');
    let correctCount = 0;
    let total = subjects.length * (usePronominal ? 2 : 1);
    let resultRows = [];

    subjects.forEach(sub => {
        const verbInput = form.elements[`verb-${sub}`];
        const pronomInput = usePronominal ? form.elements[`pronominal-${sub}`] : null;

        const userVerb = verbInput.value.trim().toLowerCase();
        const userPronom = usePronominal ? pronomInput.value.trim().toLowerCase() : null;

        const expectedVerb = verbData[currentVerb][currentTense][sub][0];
        const expectedPronom = usePronominal ? verbData[currentVerb][currentTense][sub][1] : null;

        const verbCorrect = userVerb === expectedVerb;
        const pronomCorrect = usePronominal ? userPronom === expectedPronom : true;

        verbInput.className = verbCorrect ? 'correct' : 'incorrect';
        if (usePronominal) {
            pronomInput.className = pronomCorrect ? 'correct' : 'incorrect';
        }

        if (verbCorrect) correctCount++;
        if (pronomCorrect) correctCount++;

        resultRows.push(`<li><strong>${sub}</strong>: Verb: <em>${userVerb}</em> (${verbCorrect ? '✔' : '✗'}, correct is <strong>${expectedVerb}</strong>)${usePronominal ? `; Pronominal: <em>${userPronom}</em> (${pronomCorrect ? '✔' : '✗'}, correct is <strong>${expectedPronom}</strong>)` : ''}</li>`);
    });

    const scoreBlock = document.getElementById('scoreBlock');
    scoreBlock.innerHTML = `Score for <strong>${currentTense}</strong>: ${correctCount} / ${total}`;

    prevAnswers.unshift({
        tense: currentTense,
        verb: currentVerb,
        score: `${correctCount} / ${total}`,
        detail: resultRows.join('')
    });

    showPrevious();
}

function showPrevious() {
    const prevBlock = document.getElementById('prevAnswersBlock');
    const prevList = document.getElementById('prevAnswersList');
    prevList.innerHTML = prevAnswers.map(a => `<li><b>Verb '${a.verb}', Tense ${a.tense}</b>: <span style="color:#154a7e;">${a.score}</span><ul>${a.detail}</ul></li>`).join('');
    prevBlock.style.display = prevAnswers.length ? 'block' : 'none';
}

function nextRound() {
    randomizeTense();
    clearScore();
}

function resetForm() {
    const form = document.getElementById('practiceForm');
    subjects.forEach(sub => {
        const verbInput = form.elements[`verb-${sub}`];
        const pronomInput = form.elements[`pronominal-${sub}`];
        if (verbInput) { verbInput.value = ''; verbInput.className = ''; }
        if (pronomInput) { pronomInput.value = ''; pronomInput.className = ''; }
    });
    clearScore();
}

function clearScore() {
    document.getElementById('scoreBlock').innerHTML = '';
}

searchVerb.value = '';
randomizeTense();
</script>
</body>
</html>
